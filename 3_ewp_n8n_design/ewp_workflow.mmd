---
title: EWP n8n Workflow â€” Early Warning Process
---
flowchart TD
    A([ðŸ• Schedule Trigger\nEvery 15 minutes]) --> B

    B[ðŸ—„ï¸ Postgres Node\nFetch complaint counts\nfor last 15 min window] --> C

    C[âš™ï¸ Function Node\nCompute signals:\nâ€¢ SIG-01 Volume\nâ€¢ SIG-02 Theme spike\nâ€¢ SIG-03 Severity\nâ€¢ SIG-04 Channel surge\nâ€¢ SIG-05 Keywords\nâ€¢ SIG-06 No-data] --> D

    D{Any threshold\ncrossed?}

    D -- No breach --> E[ðŸ—„ï¸ Postgres Node\nLog execution\nto ewp_audit_log]
    E --> Z([âœ… End cycle])

    D -- Breach detected --> F[âš™ï¸ Function Node\nDetermine level\nINFO / WARN / CRITICAL\nBuild alert payload\nAnonymise PII]

    F -- INFO --> G[ðŸ“Š HTTP Request\nUpdate monitoring\ndashboard via API]
    G --> E

    F -- WARN or CRITICAL --> H[âš™ï¸ Function Node\nSelect notification\nchannels by level]

    H --> I[ðŸ’¬ Slack Node\nPost alert card to\n#cx-alerts or\n#cx-critical]
    H --> J[ðŸ“§ Email Node\nSend HTML alert\nto on-call list]
    H --> K_cond{Level is\nCRITICAL?}
    K_cond -- Yes --> K[ðŸ“Ÿ PagerDuty Node\nCreate incident\nfor on-call engineer]
    K_cond -- No --> L

    I --> L[â³ Wait Node\nAwait HITL webhook\nWARN: 60 min timeout\nCRITICAL: 15 min timeout]
    J --> L
    K --> L

    L -- Webhook received --> M{Action\nfrom human?}
    L -- Timeout expired --> N[âš™ï¸ Function Node\nBuild escalation\npayload]

    M -- Acknowledged /\nInvestigating --> O[ðŸ—„ï¸ Postgres Node\nLog HITL ack\nactor + timestamp]
    M -- False Positive --> P[ðŸ—„ï¸ Postgres Node\nLog false positive\nUpdate threshold model]
    M -- Resolved --> Q[ðŸ’¬ Slack Node\nPost resolution\nmessage to channel]

    N --> R[ðŸ’¬ Slack Node\nEscalate â€” mention\nnext-tier responders]
    N --> S[ðŸ“§ Email Node\nSend escalation\nto director level]
    N --> T[ðŸ—„ï¸ Postgres Node\nLog escalation\nevent + timestamp]

    O --> Z
    P --> Z
    Q --> Z
    R --> Z
    S --> Z
    T --> Z

    style A fill:#6366F1,color:#fff,stroke:#4F46E5
    style Z fill:#10B981,color:#fff,stroke:#059669
    style D fill:#F59E0B,color:#fff,stroke:#D97706
    style M fill:#F59E0B,color:#fff,stroke:#D97706
    style K_cond fill:#F59E0B,color:#fff,stroke:#D97706
    style F fill:#3B82F6,color:#fff,stroke:#2563EB
    style N fill:#EF4444,color:#fff,stroke:#DC2626
